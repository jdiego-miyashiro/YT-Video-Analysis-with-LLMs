Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:00:00---->00:00:45]:
[Music] thank you Jimmy uh and great stuff harre and and matria as well like you guys like are doing amazing work in that area we're going to do something a little bit different now as we switch over to to my stuff let me get my screen Shar going and we're going to be talking about more on the rag side of the world so llms over to how you combine them with uh data and with specific focus on what's called graph frag I don't want to share I what I get for clicking the wrong buttons let's get that going so graph rag with what's called a knowledge graph

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:00:45---->00:01:30]:
which is a very particular kind of data modeling uh approach for information you want to share with an llm um hi I'm ABK Andreas ciger from newford J um let's get right into it and and on your time in thinking about rag applications overall uh for for me uh and I think for for many people as well there's really three sources of data you start to think about when you're trying to think about what kinds of questions people ask and how those map to different data that you might have available and so I'm going to run through that first because I think that helps really frame understanding like what a knowledge graph is and then what these graph rag access patterns really end up being you'll hear people talk about actually let me advance her a little bit there's a lot of talk about like unstructured data that's where most

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:01:30---->00:02:15]:
people start with doing any kind of rag applications um I like to just simplify that as thinking okay there's pure text or pure images or pure media of some kind that youve got and you actually want to You' got that privately somewhere you want to make that available to an llm you're not training the llm at this point but you want to be able to access that information the information that's kind of in in that space and make that available for for natural language queries this in kind of the computer science terms this is always Under the Umbrella of information retrieval but this is kind of a particular subset of information retrieval what you're doing here is really just information search you're just assuming somewhere in the data set you've got the Corpus of data there's an answer that mirrors what the person is asked so if you're gonna ask a question like you know what is Apple's

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:02:15---->00:03:00]:
primary business because somehow you don't know um you can ask that question and somewhere in the data you have hopefully it says Apple's primary business is selling phones or Services whatever whatever they claim it to be and so that's really information search on the kind of Other Extreme of this and and I think about it on a kind of a continuum there are situations where you have pure data you don't have a corpus of text or you know other kind of media but you already have data in a database that you want to be able to ask questions about and the kinds of questions you ask here tend to be different and also that the access patterns end up being very different so the kinds of questions you might ask again this is still information retrieval but it is a bit more of like information query it's not just hey go fetch me this information but tell me something you've got to

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:03:00---->00:03:45]:
actually calculate about this information and so it may not be possible to provide enough context to an llm to figure out the answer you have to actually figure out the answer and then hand it back to the llm to kind of do the uh the postprocess of like okay present it to the user in in Shakespearean Pros let's say because that's what most people want so in Shakespearean Pros you know how many iPhones did Apple sell this order is the kind of question you might ask out of a structured query to a database this ends up being the realm of text to SQL or text whatever query language you have for us the the query language in in graphs is called Cipher um as of last week There's now an ISO standard after 40 years the next ISO standard SQL is

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:03:45---->00:04:30]:
now there's a graph query language standard um as well which is pretty marvelous rolling forward here you can imagine as it always happens and as it's actually happened in some of your uh the previous talks to this morning right you end up being able to blend these techniques this is always the case right you start off like just focusing on one area or some other and you realize actually kind of mixx this stuff together and that's useful also this naturally occurs in uh you know if you happen to have like a a WordPress data site or something like that where you actually kind of have a mix of bunch of long form text plus some structured data attached to that and the kinds of access patterns end up being a blend of let me do a search with like maybe I'm going to qualify that search do some ranking on it based on the structured data I have or the opposite

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:04:30---->00:05:15]:
happens as well I want to go through the structured data and then find the text that's attached to that so you end up with strategies that kind of blend a little bit of the the pure data and the pure text in this mixed text and data realm so the mixed structured nonstructured call that semi-structured whatever you'd like to do uh in in the data set I'm about to kind of walk through the kinds of questions that have been different here are you know if you knew that there were a bunch of companies that areed impacted by chip shortage and you knew that there were you know investment portfolios that invested in these companies be great to be able to ask okay there is going to be a chip shortage whose portfolios are affected that's reaching into the company's information about like who's at risk from Chip shortage but then kind of spanning back a couple of hops all the way to like okay who's made

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:05:15---->00:06:00]:
investments into that and who's made the most Investments so if you're watching markets this is the kind of thing you might want to be able to ask and it combines doing a search with a data query in one kind of access when you start combining all this stuff together this is where graph rag kind of emerges and where knowledge graphs as a data structure kind of emerged just incidentally in the act of like kind of elaborating on the kinds of questions you want to be able to ask and expanding what the data set looks like and what your access patterns look like your strategies for accessing that you end up with both of those things the there's the data model itself grows into a combined single model that has both the text and the data mixed together and then the access patterns also kind of grow from simple just do the search or

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:06:00---->00:06:45]:
just do the text to to query language and then mixing those techniques we call that a Knowledge Graph when you combine all this stuff at once part of the reason for calling it a knowledge graph is that the data structure when it's well formed and matches well with an llm is very readable it a human can look at it and make sense of it and like read kind of through the graph like almost sentence like expressions of information so that's why we call it a knowledge graph that ends up being really nice for mapping it to to natural language questions in in a rag context and then again the access pattern that complements that is called graph rag kind of multiple modes of information retrieval whether it's search query or what we call information Discovery we're kind of combining these things and you don't know necessarily how things are

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:06:45---->00:07:30]:
connected just reiterating that I guess drilling down into a little bit again that on the search side fundamentally that ends up being people start with Vector search that's the natural place to start but it's search in general could be keyword search could be geospatial search could be whatever you can search do that on the one side uh again on the far other side on the pure data those are just turn your natural language into a query and in the middle combining those techniques you end up either using the combined techniques for doing a ranking of the vector search or expanding the context of the vector search or doing the inverse you've done a a graph query or a structured query and then you're attaching information to it and you kind of on either side you're

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:07:30---->00:08:15]:
kind of blending the the techniques to make this a little bit more concrete uh the example I'm going to go through that is my my go-to these days there's this thing called the Edgar database from from the US government that is from the Securities and Exchange Commission uh this is public data that is available um for any company that is publicly traded they've got a file with the SEC like what their business is all about this is what the the form 10ks are if you're a public company you've got to say here's what our primary business is here's the risks to our business all those kinds of things end up going into this form 10 okay then there's another set of data that we looked at called the form 13s which are from institutional um investment companies um so the companies that manage huge portfolios they've got a file as well and say Here's what we're

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:08:15---->00:09:00]:
investing in at this pet last quarter what the dollar about was number of shares those kinds of things so for the former 13s we were mostly interested in the structured data part of that like who's the company that's doing the investing how much money did they invest so that's the kind of structured data piece of it and the Forum 10ks is is all the unstructured data we ended up combining all that together there's a a data modeling strategy that I I like to recommend do the way to think about it because sometimes when people think about knowledge graphs uh if if you're familiar with them it comes along with sometimes a bit of an intimidating notion of like oh we've got to build a complete ontology of the world or the domain that you know we think is true and the reality is in practice that's useful if you need it and certainly

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:09:00---->00:09:45]:
there are domains within which which that is important but for folks who are just kind of getting started into this stuff start with the smallest possible graph and the smallest part of possible taxonomy or organization of that graph and elaborate over time don't worry about trying to uh anticipate all possible structures up front start small and kind of iterate and the iterative pattern ends up being just create some data figure out what's interesting about that data what dimension you actually want to basically index like if it's a vector search or something else and then just create some connections whatever connections seem natural and uh as soon as you start to create connections new patterns of access end up becoming possible and also new features of the data emerge just by creating those

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:09:45---->00:10:30]:
connections in in the simplest terms this is how everybody starts with rag you take a bunch of text Data the first step usually is split that up create a bunch of chunks out of that that's the same with the knowledge graph as well the simplest possible graph you can create is a graph that has no connections it is just all the nodes without the edges still valid graph uh the natural thing to do here with Tex of course is to do a text embedding of that um save that as well you can store that in a Knowledge Graph same as you can with with any kind of database these days everybody's got some version of vector search capabilities and because it is a graph though the simplest possible obvious thing to connect would be because you know you've got a sequence of chunks just turn them into a linked list and that already gives you some

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:10:30---->00:11:15]:
benefits um like being able to do things like context Windows like you've landed on one chunk you can at least get the previous chunk the next chunk up to as many chunks as you want to very easily because it's just in a link list so it's super convenient this is the overall kind of flow that you iterate through as you're kind of building up a Knowledge Graph and then iterating through uh expanding the questions you're able to answer through a rigorous kind of evil uh round trip me as a really a developer more than a data scientist like I think about this as being like kind of tdd it's like test driven development you know computer science land eval all the time figure out what works what doesn't work and often it's changing your chunking strategy but then also sometimes changing like your prompt engineering as

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:11:15---->00:12:00]:
well uh gets involved in this having done just the simplest possible graph here of just creating a linked list this is pretty much what the data model looks like chunks connected to next chunks they've got some you know identifiers attached to them the vector embedding is is stored there as well um there's actually two benefits to this because for Enterprise settings like it's nice to be able to like go through a full Rag and like you know the an llm generates some kind of response it is very important for businesses that are relying on this stuff to be able to verify and validate what the response is and like site sources and so you can actually the user hopefully um takes the time to validate okay here's what the llm just generated cool but then you also have the reference text you can look at directly

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:12:00---->00:12:45]:
and for some settings people drop the the G part of rag and that's not really interesting they actually just want to do the the first kind of round part of the round trip and actually just present the text because the text itself is what matters to folks and they're just using ANM as kind of a natural language interface rather than for generating uh content the natural next kind of Step again just thinking in sort of incremental terms here you've got all these chunks you know they came from a single document the natural thing to do like go he let's actually connected to that document and this provides yet another opportunity for actually having uh a different set of questions that are answerable because as soon as you reconstruct the structure that you started from and here's just one level

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:12:45---->00:13:30]:
of structure from the form to the chunks that we we split up there every chunk gets attached to the form that was a part of and the form will get attached to the first chunk so the the head of the link list and while you're there it's worth taking the time to generate a summary of all that chunks of all the chunks because for some questions you don't want a window of chunks a single chunk or a window of chunks you kind of want the summary because somebody's asking about that level the sort of a higher level of abstraction depending on the domain you're in that Maps much more nicely than the detail but then again as I just mentioned it's important if you take that route it's even more important the further up you go and the more you're relying on a round trip with an LM to generate stuff for the end User it's super important to be able to go

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:13:30---->00:14:15]:
drill down to the actual text that was used for for the the summary text you might have gotten quickly just kind of jumping over to the other side all the way over to the the structured data this is the form 13s I mentioned this is the Investments the very simple data model that emerges here it's just we've got a list of for this company they invested in X number of shares and Y number of at wide number value um in this public traded company the the manager name here is maybe not the most useful name because they're not managing the company it's a management investment firm but for some you know for for shortness sake it's it's a manager so this manager own stock in some company and this is one of the

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:14:15---->00:15:00]:
times where it turns out that uh Vector similarity is not helpful for the access pattern that if you had just this structured data and you stored it in a Knowledge Graph the questions that people tend to ask end up being easier to map to just find me variations of the spelling of the company either the management firm or the the public company and so you end up with a full text index on the names for for either of those because people usually ask for and sometimes mistype um or don't use the right capitalization all those kinds of things but they're interested in tell me about Apple tell me about you know um net app or whoever it might be and you end up with a full taex index instead of a vector search there's another opportunity here for yet another kind of index I suppose

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:15:00---->00:15:45]:
that because we know the addresses of these folks folks um it's useful to be able to do you know geospatial indexing as well and we we now basically end up with three strategies just still looking at the data not getting too clever yet of you might ask kind of arbitrary questions that are going to be coming from the the pure text but as soon as you've got to the structured data you might be asking questions that are better found through look doing a lookup for the um company names and then you can also do things like what companies are near other companies so what management investment firms have invested in companies that are nearby them and do analysis based on that um so now you have three strategies for actually asking different kinds of questions with the structured and unstructured data the next step of course then is to combine the structured and unstructured

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:15:45---->00:16:30]:
data that these public companies filed these forms and this is when you get to actually do the the full blend of all the different strategies you can do some Vector you can do do spatial plus Vector all the things kind of apply and because it's all in a graph you could also do pattern matching um so you could ask simple questions like um what is uh what what companies of Black Rock the investment firm Black Rock which is based in New York City or something I think right um who have they done the most investments in you can actually do the pattern match on that from the just the manager to the company and find that information and then have like a kind of a follow-up question for like okay here's what those companies are really primarily doing that drills down into the unstructured data um so you get

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:16:30---->00:17:15]:
these kind of workflows that people can can do when they're doing market analysis by kind of alternating between arbitrary things you might find in the text versus specific things that they're trying to look for that's really captured best in in a structured data and you combine that with Vector search other index lookups and then pattern matching this is the summary slide that I have for like the process for this particular data set the kind of iterative process I I ended up going through from just the pure data I'm sorry just the unstructured data to combining it with the structured data and then all the elaborations I did for like whether it's Vector embedding full text or geospatial that I added as you do things like working with a company or like working for your for

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:17:15---->00:18:00]:
your own interests what you're trying to investigate the kinds of questions that you want to ask that aren't answerable you end up just elaborating in the same way you follow the same pattern for like okay there's a question I've asked that doesn't map neatly to any of these techniques either there's information that's missing or there's relationships that are missing and you down the path of doing things like named entity recognition pulling out interesting topics that the you know baby companies are in uh something that I skipped over here that uh I probably should have done is most of these filings the companies actually site other companies and so it'd be really interesting to actually just do that connection be like here's a company that does business with you know these other companies in some way once you add that you can then also do you know graph analytics on that things like

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:18:00---->00:18:45]:
um centrality query so like a page rank effectively do you end up finding out like who's the most influential company or the most the company that other companies depend on the most you can do those kinds of queries annotating the graph with that but then also exposing that through graph rag access patterns this continues on through all the different things you can extract from the data but then also keeping track of who the particular user is who's asking questions and fine-tuning things fine-tuning I'm sorry it's the wrong word to use with this with this audience I'm sure refining is maybe the better thing to say refining that your strategy for how you map a user question to the answers based on what you know about the user that somebody uh two different people asking the same question you're going to ask it in a different way and mean something different because of

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:18:45---->00:19:30]:
their context so the more you know about the user and their history of asking questions you bring all that in for actually ranking the data that's available when you get results um and also allow the user to provide feedback that you also then store in the knowledge graph okay that is my Whirlwind tour graph Rag and Knowledge Graph um all the stuff I've shown here is available in some uh notebooks and python notebooks that are out on on GitHub um that are live notebooks I should say so at any given instance they're all broken or working great um because I keep kind of working with this data and it changes a little bit um but please feel free to reach out to me if you've got any questions um I'm Andre either andre. new forj or just Andre for J all right fantastic so there are there

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:19:30---->00:20:15]:
is one question in the Q&A but before we get to that question the Q&A there were two that ended up in the webinar chat looks like my cat wants to get on the show uh so I think the first question was from Henry and I'll try to give you context I think it was when you were on slide 24 uh so if you want to bounce back to your slide 24 maybe the question will have context I read it out uh the question is are the chunks connected to each other based on spatial location in the text oh great great question so not in this part so in this stage here all I've done is the the sequence of chunks that as they were split up um I just put them into a linked list so that they are sequential so that you could effectively

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:20:15---->00:21:00]:
page through um the text directly so it's not in terms of their internally whether they're similar or not um although that's something that we in other context have also end up doing so you end up with clusters of chunks that point to each other cool and I think the next question that was in the webinar chat that would H that was asked around slide 21 or 22 in the create enhance connect uh form 10K slide I think I I don't know if there's enough context here with this question but the question was how how you save that separate or within the nodes I don't I don't know if that's helpful um oh maybe it's got to do with like chunking strategy I'm going to guess let

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:21:00---->00:21:45]:
me know in the comments if I'm ahead of down the wrong direction but that even at this stage this is um if that's the question I think it's it's a great question chunking is hard to do well um folks start down the path of chunking because of contact windows and they're trying to get like just enough taxt to be appropriate for the for the question and passing that through as context wins of thrown the different criteria actually ends up being finding the right siiz chunks that are most likely to mirror the question that is asked um because sometimes you'll get actually the information is appropriate or or best found in a chunk that doesn't have highest similarity score if you've got chunks that are too big um and it all depends on like what the embedding strategy is as well I guess what what you're using for embeddings so highly

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:21:45---->00:22:30]:
sensitive to like what you're using for the embeddings and then what the actual text is for like what your chunking strategy ends up being but the fundamental driver ends up like trying to mirror um what the questions are that you're anticipating um so there's a lot of art involved in all of that all right so I think that your abil to have an intuition about what the question was based on your on the question itself was pretty good because I think we have to followup in the webinar TR it was during the embedding do you put the embeddings in the nodes that are chunked or do they stay separate it sounds like you were close yeah yeah that's right so the the embeddings and the text itself get stored in the chunks um so the chunks end up being data records basically uh in the database and the the vector

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:22:30---->00:23:15]:
embedding itself is just in aray of floats um that is backed by an index that is able to do Vector similarity search so cosine similarity is the typical thing we use okay awesome then I think we can bounce finally down into the Q&A uh cue and I think the first question is actually just uh looking to connect with you over some uh topics so maybe we can take that one offline but the but the next two uh definitely are questions worth uh looking at okay so let me bounce over to that uh I can just read them to you the first question is should semantic chunks help the size of chunks can we give per can we give per node in neo4j should semantic chunks help the

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:23:15---->00:24:00]:
size of chunks can we give per node in Neo 4J so this is back I think around the same topic of like chunking strategies and um it is highly dependent on your domain uh there's no perfect answer here uh for for example like for some of Enterprises that deal with um that are doing this stuff right now they have a lot of information that they use from legislation where the basically the what they really want is like in the very structured unstructured data like for subsection 3.25 they want that to be a chunk whether it is a single sentence or two paragraphs right so ends up being very dependent on your domain there might be the domain might have enough hints about

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:24:00---->00:24:45]:
the chunk size that you want that to determine what's going on rather than arbitrary character length or give me two paragraphs or one sentence you know in in other domains those very domain dependent all right and then our last question is actually a two for one uh so it's a two-parter uh could you tell me about the management graph of updates and then second what is the security of the graph method okay interesting um so I'm going to answer those in reverse order because the second is easy uh you get to apply security rules to the graph um access rules so you have role based access control over the graph itself and so if you do know the user who's asking the question and you have some um role-based

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:24:45---->00:25:30]:
access control over that then that also constrains what they're able to see that is either either happens as kind of a post-process if you're doing a vector search it doesn't apply on into the vector search but like when you then tie in the vector search with the nodes that are result that's when the visibility ends up hitting so you still search for stuff but then it won't be visible to the end user if they're not allowed to see that part of the graph um and definitely on the the pure data side all those things apply directly um for what they can actually perform in terms of queries a lot of interesting actually subex of that that I want to get into and I forgotten the first part of the question which one oh so the other part was how do you manage updates uh manage management of the graph updates yeah so it's um all the techniques you're used

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:25:30---->00:26:15]:
to for managing any kind of database updates uh basically apply here um one of the small advantages I guess of being a graph is that you can sometimes updates means if you're doing like data migrations and things there usually aren't data migrations involved in in graph structures like as I was talking through kind of evolving the graph that's not a migration every time you're just kind of accumulating stuff you don't have to that's you don't have to pred decide all the structure first you just add structures you would like to and that that's really nice but for doing data uh adding data it's just upserts um so if you already have data you just do an up search basically all right and we have one last question that's snuck in and we're g to we're going to take it anyway how do you do the index search or pattern matching after you get the required chunks using

Video Extract : Computer Vision Meetup: GraphRAG with a Knowledge Graph
[00:26:15---->End of Video]:
distance Bas similarity search right so that ends up basically being Brute Force um so if you do a pattern match first typically that ends up constraining the number of chunks that you hit um and if you're hitting less than you know uh probably even like up to like 10,000 or something like it's as fast to just do the calculation yourself so like in in the queries in the cipher query that you can write you do a pattern match and then you kind of do a post process of that where you're just actually going through all the nodes and just calculating the coine yourself rather than doing an index lookup for it um because it's small enough batches that it's the pattern matching is reduced the size overall that that's not impactful [Music]

